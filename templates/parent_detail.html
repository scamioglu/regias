{% extends "base.html" %}
{% block content %}
<h3>Parent: {{ parent.name }}</h3>
<ul class="nav nav-tabs">
    {% for stage in stages %}
        <li class="nav-item">
            <a class="nav-link {% if loop.first %}active{% endif %}" data-bs-toggle="tab" href="#stage_{{ stage.id }}">{{ stage.stage_name }}</a>
        </li>
    {% endfor %}
</ul>
<div class="tab-content mt-3">
    {% for stage in stages %}
        <div class="tab-pane fade {% if loop.first %}show active{% endif %}" id="stage_{{ stage.id }}">
            {% for answer in answers if answer.form_id in forms|selectattr('stage_id', 'equalto', stage.id)|map(attribute='id') %}
                <div class="card mb-3">
                    <div class="card-body">
                        <p><strong>{{ answer.question }}</strong></p>
                        <p>{{ answer.answer or 'N/A' }}</p>
                        {% if answer.file_path %}
                            <img src="{{ answer.file_path }}" class="img-fluid" style="max-width: 200px;">
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endfor %}
</div>
{% endblock %}